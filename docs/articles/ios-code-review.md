# iOS 代码审核
## git 工作流
git 工作流比较流行的就是 Git Flow 了。下图是其工作的流程。

从上面我们可以看出 git 分支大致分为 5 个，它们又可以分为两类。

### 永久分支

master 和 develop 这两个分支被称作为 永久分支。它们会存活在项目的整个生命周期中。
#### master

1. master分支中的任何版本都认为是可以立即部署的。
2. 每一次master分支的变更都来自于其它分支向master的合并操作。 
3. 不要在直接在master上修改代码。
4. 每次发版注意打版本 tag。

#### develop
develop 是进行任何新的开发的基础分支。当开始一个新的功能分支时，它将是_开发_的基础。另外，该分支也汇集所有已经完成的功能，并等待被整合到 master 分支中。
### 临时分支
这些分支都是临时存在的，相应功能完成后会被删除，有下一个需求再进行创建。
#### feature
当开始开发一个特性的时候，如果该特性不确定是否发布就需要开一个 feature 分支来开发。该分支的重点是，只要特性还在开发，该分支就会一直存在，不过它最终会被合并回develop分支（将该特性加入到发布版本中），或者被丢弃（如果试验的 结果令人失望）。

#### hotfix
当线上产品发现未预期的问题的时候，就需要理解着手处理，这个时候就要用到 hotfix。修复完会合并到 master 和 develop。

#### release
准备发布的状态，用来预发、修复bugs，基于 develop, 完成后 merge 回 develop 和 master 。

## code review 流程
在做 code review 的时候可以结合 Gitflow 并进行适当的修改，并通过 gitlab 的 pull request 来实现。具体做法如下。

1. 每一个大功能创建一个单独的 feature 分支，比如对于登录功能创建 `feature/login` 分支，其代码来源就是 `master` -> `develop` -> `feature/login`
2. 具体开发人员根据细分的任务从上面创建的 `feature/login` 分支来创建分支，比如登录功能的注册功能就创建 `feature/login/register` 
3. 当细分的任务完成后立即向上游的分支提交 pull request，比如请求合并 `feature/login/register` 到 `feature/login` 之中。
4. 开发人员提交 PR 后立刻开始下一个细分的任务，比如登录的完善信息功能，创建新的分支 `feature/login/perfectInfo`。
5. 相关人员收到 PR 后对代码进行 Review，如果需要进行必要的修改，修改在原分支修改，修改完毕代码合并进上游分支，原分支会定期删除。
6. 项目组其他成员在收到合并成功的通知后，请自行从上游大特性分支向下合并到自己当前的开发分支。

> <font color='red'>**注意**</font>
> 
在拆分功能的时候必须保证拆分出来的功能是相对独立而且可用的，一般情况下分支任务工作量0.5-1个工作日，不宜超过2个工作日，超过2个工作日不向上游合并，需要做特殊说明。

